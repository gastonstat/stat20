---
title: "Summarizing Numerical Associations"
format:
  stat20slides-revealjs:
    chalkboard: true
---

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
library(tidyverse)
```


## Agenda

-   Announcements
-   Concept Questions
-   Worksheet
-   *Break*
-   Lab 2.2 (extended): Computing on The Data


## Announcements

-   Reading Questions

. . . 

-   Lab 2.2

. . . 

-   Worksheet


# Concept Questions

## Estimate the correlation

```{r}
countdown::countdown(1, top = 0)
```

:::{.poll}
What is the (Pearson) correlation coefficient between these two variables?
:::

```{r}
#| fig-align: center
#| fig-width: 5
#| fig-height: 3
n_samples <- 100
set.seed(1)
x <- runif(n = n_samples, min = -1, max = 1) 
y <- -x + rnorm(n = n_samples, mean = 0, sd = .1)

data.frame(x = x, 
           y = y) |> 
  ggplot(aes(x = x, y = y)) +  
  geom_point() +
  theme_bw()
```

:::notes
This plot has a strong negative linear association, so the correlation coefficient will be around -.8 or -.9.

The goal of this exercise is threefold:
- Start calibrating the ability to associate the correlation with the structure in a scatter plot.
- Make it clear that this is still just an informal eye-balling procedure (therefore multiple answers can be reasonable, but some are un-reasonable).
- Set some of them up for a challenge on the next one; some will conflate correlation with association.
:::


## 

```{r}
#| fig-align: center
#| fig-width: 8
#| fig-height: 5

# simulate data -----------------------------------------------------
set.seed(9274)

x1 <- seq(0, 6, by = 0.05)

y_u <- (x1-3)^2 - 4 + rnorm(length(x1), mean = 0, sd = 1)
y_lin_pos_strong <- 3*x1 + 10 + rnorm(length(x1), mean = 0, sd = 2)
y_lin_pos_weak <- 3*x1 + 10 + rnorm(length(x1), mean = 0, sd = 20)

x2 <- seq(-8, -2, by = 0.05)

y_n <- -1 * (x2 + 5)^2 + 1 + rnorm(length(x2), mean = 0, sd = 2)
y_lin_neg_strong <- -5 * x2 + 3 + rnorm(length(x2), mean = 0, sd = 2)
y_none <- rnorm(length(x2), mean = 0, sd = 1)

df <- data.frame(x = c(rep(x1, 3), rep(x2, 3)),
                 y = c(y_u, y_lin_pos_strong, y_lin_pos_weak,
                       y_n, y_lin_neg_strong, y_none),
                 plot_num = rep(LETTERS[1:6], each = length(x1)))

library(tidyverse)
pa <- df |>
    filter(plot_num == "A") |>
    ggplot(aes(x = x, 
               y = y)) +
    geom_point() +
    facet_wrap(vars(plot_num), scales = "free") +
    theme_bw(base_size = 14) +
    theme(axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank()) +
    labs(x = "",
         y = "")

pb <- df |>
    filter(plot_num == "B") |>
    ggplot(aes(x = x, 
               y = y)) +
    geom_point() +
    facet_wrap(vars(plot_num), scales = "free") +
    theme_bw(base_size = 14) +
    theme(axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank()) +
    labs(x = "",
         y = "")

pc <- df |>
    filter(plot_num == "C") |>
    ggplot(aes(x = x, 
               y = y)) +
    geom_point() +
    facet_wrap(vars(plot_num), scales = "free") +
    theme_bw(base_size = 14) +
    theme(axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank()) +
    labs(x = "",
         y = "")

pd <- df |>
    filter(plot_num == "D") |>
    ggplot(aes(x = x, 
               y = y)) +
    geom_point() +
    facet_wrap(vars(plot_num), scales = "free") +
    theme_bw(base_size = 14) +
    theme(axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank()) +
    labs(x = "",
         y = "")

pe <- df |>
    filter(plot_num == "E") |>
    ggplot(aes(x = x, 
               y = y)) +
    geom_point() +
    facet_wrap(vars(plot_num), scales = "free") +
    theme_bw(base_size = 14) +
    theme(axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank()) +
    labs(x = "",
         y = "")

pf <- df |>
    filter(plot_num == "F") |>
    ggplot(aes(x = x, 
               y = y)) +
    geom_point() +
    facet_wrap(vars(plot_num), scales = "free") +
    theme_bw(base_size = 14) +
    ylim(-9, 9) +
    theme(axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank()) +
    labs(x = "",
         y = "")

library(patchwork)
(pa + pb + pc) / (pd + pe + pf)
```

:::{.poll}
Which *four* plots exhibit the strongest association?
:::

```{r}
countdown::countdown(1, top = 0)
```

:::{.notes}
Student will likely identify A, B, E, and F. F only appears to be highly associated because of the scaling of the y-axis. This is a good opportunity to review definition of association. The following slides demonstrate the effects of that scaling.
:::

## Correlation and Scale {auto-animate=true}

```{r}
#| echo: false
df_f <- filter(df, plot_num == "F") |>
    select(x, y)
```


:::: {.columns}

::: {.column width="45%"}
```{r}
#| echo: true
#| eval: false
df_f
```
:::

::: {.column width="55%"}

:::

::::

## Pearson Correlation and Scale {auto-animate=true}

:::: {.columns}

::: {.column width="45%"}
```{r}
#| echo: true
df_f
```
:::

::: {.column width="55%"}

:::

::::

## Pearson Correlation and Scale {auto-animate=true}

:::: {.columns}

::: {.column width="45%"}
```{r}
#| echo: true
#| eval: false
df_f |>
    ggplot(aes(x = x,
               y = y)) +
    geom_point() +
    ylim(-9, 9) +
    theme_bw()
```
:::

::: {.column width="55%"}

:::

::::

## Pearson Correlation and Scale {auto-animate=true}

:::: {.columns}

::: {.column width="45%"}
```{r}
#| echo: true
#| eval: false
df_f |>
    ggplot(aes(x = x,
               y = y)) +
    geom_point() +
    ylim(-9, 9) +
    theme_bw()
```
:::

::: {.column width="55%"}
```{r}
#| echo: false
#| eval: true
#| fig-height: 8
df_f |>
    ggplot(aes(x = x,
               y = y)) +
    geom_point(size = 5) +
    ylim(-9, 9) +
    theme_bw(base_size = 36)
```
:::

::::

## Pearson Correlation and Scale {auto-animate=true}

:::: {.columns}

::: {.column width="45%"}
```{r}
#| echo: true
#| eval: false
df_f |>
    ggplot(aes(x = x,
               y = y)) +
    geom_point() +
    theme_bw()
```
:::

::: {.column width="55%"}

:::

::::

## Pearson Correlation and Scale {auto-animate=true}

:::: {.columns}

::: {.column width="45%"}
```{r}
#| echo: true
#| eval: false
df_f |>
    ggplot(aes(x = x,
               y = y)) +
    geom_point() +
    theme_bw()
```
:::

::: {.column width="55%"}
```{r}
#| echo: false
#| eval: true
#| fig-height: 8
df_f |>
    ggplot(aes(x = x,
               y = y)) +
    geom_point(size = 5) +
    theme_bw(base_size = 36)

```
:::

::::

## Pearson Correlation and Scale {auto-animate=true}

```{r}
#| echo: true
#| eval: false
df_f |>
    summarize(pearson = cor(x, y))
```


## Pearson Correlation and Scale {auto-animate=true}

```{r}
#| echo: true
df_f |>
    summarize(pearson = cor(x, y))
```


<!-- ## Non-linear Associations -->

<!-- ```{r} -->
<!-- countdown::countdown(3, top = 0) -->
<!-- ``` -->

<!-- ```{r} -->
<!-- #| fig-align: center -->
<!-- #| fig-width: 5 -->
<!-- #| fig-height: 3 -->
<!-- n_samples <- 100 -->
<!-- set.seed(1) -->
<!-- x <- runif(n = n_samples, min = -1, max = 1)  -->
<!-- y <- x^2 + rnorm(n = n_samples, mean = 0, sd = .1) -->

<!-- data.frame(x = x, y = y) |> -->
<!--   ggplot(aes(x = x, y = y)) + -->
<!--   geom_point() + -->
<!--   theme_bw() -->
<!-- ``` -->


<!-- :::{.poll} -->
<!-- #### Group discussion -->

<!-- Come up with at least one example from real life where you might expect to see this kind of U-shaped association. Come up with another example of an inverted U-shape. -->
<!-- ::: -->

## Describing Associations

When considering the structure in a scatter plot, pay attention to:

1. The strength of the association
   - *How much does the conditional distribution of y change when you move along the x?*
   
. . .

2. The shape of the association
   - *Linear? Quadratic? Cubic or beyond?*
   
. . .

3. The direction of the (linear) association
   - *Positive or negative?*


# WS: Summarizing Numerical Associations 

```{r echo = FALSE}
countdown::countdown(minutes = 25, top = 1)
```

# Break

```{r echo = FALSE}
countdown::countdown(minutes = 5, top = 0)
```

# Lab 2.2 (extended): Computing on The Data

```{r echo = FALSE}
countdown::countdown(minutes = 35, top = 1)
```

# End of Lecture

